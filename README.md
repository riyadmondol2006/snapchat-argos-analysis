# Snapchat Argos Analysis

## ⚠️ Educational Research Only

This repository contains reverse engineering research and analysis of Snapchat's Argos attestation token system (v13.51.0.56) for educational purposes only.

### 🚨 Disclaimer
- This is **NOT** a working token generator
- Tokens generated by the simulator are **NOT valid** for Snapchat's servers
- This research is for understanding mobile security architecture
- No actual bypass or exploitation is provided or possible
- For educational and security research purposes only

## 📋 Table of Contents
- [Overview](#overview)
- [Research Findings](#research-findings)
- [Repository Structure](#repository-structure)
- [Technical Details](#technical-details)
- [Tools Used](#tools-used)
- [Legal Notice](#legal-notice)
- [Author](#author)

## 🔍 Overview

This research project analyzes Snapchat's client attestation system called "Argos" which generates authentication tokens (`x-snapchat-att-token`) for API requests. The analysis was performed on Snapchat Android APK version 13.51.0.56.

### Key Discoveries
- **Token Header**: `x-snapchat-att-token`
- **Signature Header**: `x-snapchat-att-sign`
- **Backend Service**: `gcp.api.snapchat.com` (Google Cloud Platform)
- **Implementation**: Native C++ with JNI bindings
- **Security**: Hardware attestation + Cryptographic signatures

## 🔬 Research Findings

### Architecture Overview
```
Java Layer (APK) → JNI Bridge → Native Library (libclient.so) → gRPC → GCP Backend
```

### Security Implementation
1. **Hardware Attestation**
   - Google SafetyNet (Android)
   - Apple DeviceCheck (iOS)
   - Device integrity verification

2. **Cryptographic Operations**
   - AES-GCM encryption (AESGCC20)
   - ChaCha20-Poly1305
   - RSA signatures
   - HMAC authentication

3. **Token Management**
   - Binary cache storage (`/token.bin`)
   - TTL-based expiration
   - Queue-based request management

## 📁 Repository Structure

```
├── argos_analysis.md                    # Initial analysis findings
├── native_code_analysis.md              # Native library analysis
├── detailed_native_analysis.md          # Deep dive into implementation
├── token_generation_flow.md             # Complete token generation flow
├── memory_addresses_and_locations.md    # Memory map and addresses
├── deep_analysis_update.md              # Additional findings
├── complete_argos_implementation.md     # Full implementation details
├── FINAL_COMPLETE_ANALYSIS.md          # Comprehensive summary
├── argos_token_generator.py            # Basic educational simulator
├── enhanced_token_generator.py         # Advanced simulator with all features
├── token_simulator.py                  # Interactive demonstration tool
└── README.md                           # This file
```

## 🛠 Technical Details

### Native Functions (libclient.so)
```
0x00c1b180 - ArgosClient::createInstance
0x00dd3504 - ArgosClient::getAttestationHeaders  
0x00c1dd9c - ArgosClient::getArgosTokenAsync
0x00dd33b0 - ArgosClient::nativeDestroy
```

### Token Structure
```json
{
    "v": 1,                    // Version
    "t": 1234567890000,       // Timestamp
    "m": "STANDARD",          // Mode
    "d": "device_id",         // Device ID
    "p": "attestation_data",  // Payload
    "s": "signature",         // Signature
    "k": 1                    // Key version
}
```

### gRPC Service
- **Endpoint**: `/snap.security.ArgosService/GetTokens`
- **Request**: `GetTokensRequest` protobuf
- **Response**: `GetTokensResponse` protobuf

## 🔧 Tools Used

- **APK Analysis**: apktool, jadx
- **Binary Analysis**: strings, hexdump, objdump
- **Smali Analysis**: Manual inspection
- **Documentation**: Extensive markdown files

## ⚖️ Legal Notice

This research is conducted under fair use provisions for educational and security research purposes. It aims to understand and document mobile application security implementations.

**Important**:
- This research does not enable bypassing Snapchat's security measures
- No private keys or proprietary algorithms are exposed
- The simulators produce non-functional tokens for educational demonstration only
- Using this research to attempt unauthorized access is illegal and unethical

## 🔐 Why Tokens Cannot Be Forged

1. **Hardware Dependency**: Requires genuine device attestation that cannot be simulated
2. **Cryptographic Keys**: Private keys are hardware-protected and never exposed
3. **Server Validation**: All tokens are verified server-side with Google/Apple
4. **Device Registration**: Each device must be properly registered with Snapchat

## 📚 Educational Value

This research provides insights into:
- Modern mobile app security architecture
- Hardware-backed attestation systems
- Multi-layer security implementations
- Native code protection techniques
- gRPC/protobuf communication patterns

## 👨‍💻 Author

**Riyad Mondol**
- GitHub: [@riyadmondol2006](https://github.com/riyadmondol2006)
- Website: [riyadm.com](https://riyadm.com)
- Reverse Engineering: [reversesio.com](http://reversesio.com/)
- Telegram: [@riyadmondol2006](https://t.me/riyadmondol2006)
- YouTube: [@reversesio](https://www.youtube.com/@reversesio)

## 📝 Contributing

This is a research project. If you have additional insights or corrections:
1. Fork the repository
2. Create a feature branch
3. Submit a pull request with detailed explanation

## ⭐ Acknowledgments

- Snapchat for implementing robust security measures
- The reverse engineering community for tools and techniques
- Educational institutions promoting security research

## 📜 License

This research is provided "as is" for educational purposes. See LICENSE file for details.

---

**Remember**: This research is for learning about mobile security. Always respect application terms of service and use technology ethically.