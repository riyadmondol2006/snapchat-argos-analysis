# Snapchat Att-Token (Argos) Analysis

## Overview
Snapchat uses a client attestation system called "Argos" to generate authentication tokens (att-tokens) for API requests.

## Key Components Found

### 1. Argos Client Architecture
- **Main Interface**: `com.snapchat.client.client_attestation.ArgosClient`
  - Native implementation in `libclient.so`
  - Uses JNI for Java-Native communication

### 2. Token Header
- **Header Name**: `x-snapchat-att-token`
- Generated by native code in the client library

### 3. Key Classes/Enums
- `ArgosRefresReason`: Enum for token refresh reasons
  - PREWARMING
  - PREEMPTIVEREFRESH
  - BLOCKINGREFRESH
  
- `ArgosType`: Token type enumeration
  - NONE
  - LEGACYARGOS
  - ARGOS
  - BOTH

- `ArgosMode`: Different modes for attestation

### 4. Native Functions
From `libclient.so`:
- `Java_com_snapchat_client_client_1attestation_ArgosClient_createInstance`
- `Java_com_snapchat_client_client_1attestation_ArgosClient_00024CppProxy_native_1getAttestationHeaders`
- `Java_com_snapchat_client_client_1attestation_ArgosClient_00024CppProxy_native_1getArgosTokenAsync`
- `get_argos_token` (internal function)

### 5. Token Generation Process
1. ArgosClient is initialized with:
   - PlatformClientAttestation
   - Configuration
   - AuthContextDelegate
   - ArgosPlatformBlizzardLogger
   - DispatchQueue

2. Token generation methods:
   - `getAttestationHeaders()`: Synchronous method
   - `getArgosTokenAsync()`: Asynchronous method with callback

3. Parameters for token generation:
   - URL/endpoint
   - HTTP method
   - Request body (optional)
   - ArgosMode

## Security Implementation
The actual token generation algorithm is implemented in native code (C++) within `libclient.so`, making it harder to reverse engineer. The native library likely implements:
- Device fingerprinting
- Cryptographic operations
- Platform-specific attestation
- Anti-tampering checks

## Token Refresh Events
Token refresh is tracked with:
- Success/failure status
- Latency metrics
- Payload generation latency
- Refresh reason

## Integration Points
- Used in gRPC requests (`com.snapchat.client.grpc`)
- HTTP requests include the token in headers
- Token is refreshed based on various triggers